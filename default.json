{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  // Basic rules for all repositories
  "extends": ["config:best-practices"],
  // Global timezone and schedule
  "timezone": "Europe/Rome",
  // Renovate schedule strings can be picky: keep entries explicit
  "schedule": [
    "before 08:00 on Monday",
    "before 08:00 on Tuesday",
    "before 08:00 on Wednesday",
    "before 08:00 on Thursday"
  ],
  // Avoid PR floods on the first run / after long inactivity
  "prHourlyLimit": 5,
  "prConcurrentLimit": 10,
  // Noise reduction: avoid very fresh updates
  "minimumReleaseAge": "2 days",
  // Ensure patch/minor are separated from majors
  "separateMajorMinor": true,
  "separateMinorPatch": true,
  // Group some ecosystems and define update policies
  "packageRules": [
    {
      "groupName": "Test & QA (Node)",
      "matchManagers": ["npm"],
      "matchPackagePatterns": [
        "^@?jest",
        "vitest",
        "mocha",
        "chai",
        "cypress",
        "playwright",
        "@testing-library",
        "msw"
      ],
      "automerge": false
    },
    {
      "groupName": "Test & QA (Java)",
      "matchManagers": ["maven"],
      "matchPackagePatterns": [
        "^org\\.junit",
        "^junit:junit$",
        "^org\\.mockito",
        "^org\\.assertj",
        "^org\\.hamcrest",
        "^org\\.testcontainers",
        "junit-jupiter",
        "mockito-core",
        "assertj-core"
      ],
      "automerge": false
    },
    {
      "groupName": "CI/CD (Actions)",
      "matchManagers": ["github-actions"],
      "matchPackagePatterns": ["^actions/", "^docker/", "^github/"],
      "automerge": false
    },
    {
      "groupName": "CI/CD tooling (Node)",
      "matchManagers": ["npm"],
      "matchPackagePatterns": [
        "^husky$",
        "^lint-staged$",
        "^semantic-release$",
        "^@commitlint/",
        "^commitlint",
        "^release-please"
      ],
      "automerge": false
    },
    {
      "groupName": "Frontend tooling (Node)",
      "matchManagers": ["npm"],
      "matchPackagePatterns": [
        "eslint",
        "prettier",
        "vite",
        "webpack",
        "babel"
      ],
      "automerge": false
    },
    // Policy for patch/minor/major
    {
      "matchUpdateTypes": ["patch"],
      "matchManagers": ["npm"],
      "matchDepTypes": ["devDependencies"],
      "automerge": true,
      "automergeType": "pr"
    },
    {
      "matchUpdateTypes": ["patch"],
      "matchManagers": ["github-actions"],
      "automerge": true,
      "automergeType": "pr"
    },
    {
      "matchUpdateTypes": ["digest"],
      "matchManagers": ["dockerfile"],
      "automerge": true,
      "automergeType": "pr"
    },
    {
      "matchUpdateTypes": ["minor"],
      "automerge": false
    },
    {
      "matchUpdateTypes": ["major"],
      "automerge": false,
      "prPriority": -1,
      "labels": ["major-update"]
    },
    // OpenSSF Scorecards integration in PR bodies
    {
      "matchSourceUrls": ["https://github.com/**"],
      "prBodyDefinitions": {
        "OpenSSF": "[![OpenSSF Scorecard](https://api.securityscorecards.dev/projects/github.com/{{sourceRepo}}/badge)](https://securityscorecards.dev/viewer/?uri=github.com/{{sourceRepo}})"
      },
      "prBodyColumns": [
        "Package",
        "Type",
        "Update",
        "Change",
        "Age",
        "Adoption",
        "Passing",
        "Confidence",
        "Pending",
        "OpenSSF"
      ]
    }
  ],
  // Shared lockfile maintenance
  "lockFileMaintenance": {
    "enabled": true,
    "schedule": ["before 04:00 on Monday"],
    "automerge": false
  },
  // Common labels for all Renovate PRs
  "labels": ["dependencies"],
  // Keep PRs clean and tidy
  "rebaseWhen": "behind-base-branch",
  // Enable standardized semantic commits in Renovate PRs
  "semanticCommits": "enabled",
  "commitBody": "Generated by Renovate Bot"
}
